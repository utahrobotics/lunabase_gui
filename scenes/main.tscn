[gd_scene load_steps=11 format=2]

[ext_resource path="res://scripts/controllable_node.gd" type="Script" id=1]
[ext_resource path="res://scenes/bot.tscn" type="PackedScene" id=2]
[ext_resource path="res://scripts/pathing_render.gd" type="Script" id=3]
[ext_resource path="res://scenes/position_gizmo.tscn" type="PackedScene" id=4]
[ext_resource path="res://scenes/rotation_gizmo.tscn" type="PackedScene" id=5]

[sub_resource type="GDScript" id=1]
script/source = "extends Label


func _handle_bot_data(parsed: Dictionary) -> void:
	if not BotServer.AUTONOMY_STAGE in parsed:
		return
	text = parsed[BotServer.AUTONOMY_STAGE].capitalize()
"

[sub_resource type="GDScript" id=2]
script/source = "extends CheckButton


func _input(event):
	if event.is_action_pressed(\"change_autonomy\"):
		BotServer.autonomy = not BotServer.autonomy


func _on_pressed():
	BotServer.autonomy = not BotServer.autonomy
"

[sub_resource type="GDScript" id=3]
script/source = "extends Label


func _ready():
	# warning-ignore:return_value_discarded
	BotServer.connect(\"packet_received\", self, \"_update_delay\")


func _update_delay(delay: int):
	text = str(delay) + \" ms\"
"

[sub_resource type="GDScript" id=4]
script/source = "extends Label


func _on_Camera_camera_lock_changed(val):
	if val:
		text = \"Camera Locked\"
		set(\"custom_colors/font_color\", Color.red)
	else:
		text = \"Camera Unlocked\"
		set(\"custom_colors/font_color\", Color.green)
"

[sub_resource type="GDScript" id=5]
script/source = "extends Button


onready var line_edit: LineEdit = $\"../LineEdit\"


func _on_ManualHome_pressed():
	if not line_edit.text.is_valid_integer(): return
	disabled = true
	BotServer.manual_home(int(line_edit.text))


func _ready():
	BotServer.connect(\"manual_home_complete\", self, \"set_disabled\", [false])
"

[node name="Spatial" type="Spatial"]

[node name="Line2D" type="Line2D" parent="."]
script = ExtResource( 3 )

[node name="LeftHUD" type="VBoxContainer" parent="."]
anchor_right = 0.5
anchor_bottom = 1.0
margin_left = 7.0
margin_top = 7.0
__meta__ = {
"_edit_use_anchors_": false
}

[node name="HBoxContainer" type="HBoxContainer" parent="LeftHUD"]
margin_right = 505.0
margin_bottom = 14.0

[node name="Label" type="Label" parent="LeftHUD/HBoxContainer"]
margin_right = 112.0
margin_bottom = 14.0
text = "Autonomy Stage: "

[node name="Label2" type="Label" parent="LeftHUD/HBoxContainer"]
margin_left = 116.0
margin_right = 173.0
margin_bottom = 14.0
text = "MANUAL"
script = SubResource( 1 )

[node name="HBoxContainer2" type="HBoxContainer" parent="LeftHUD"]
margin_top = 18.0
margin_right = 505.0
margin_bottom = 58.0

[node name="Label" type="Label" parent="LeftHUD/HBoxContainer2"]
margin_top = 13.0
margin_right = 92.0
margin_bottom = 27.0
text = "Autonomy Bit:"

[node name="CheckButton" type="CheckButton" parent="LeftHUD/HBoxContainer2"]
margin_left = 96.0
margin_right = 172.0
margin_bottom = 40.0
focus_mode = 0
pressed = true
script = SubResource( 2 )

[node name="ViewportContainer" type="ViewportContainer" parent="LeftHUD"]
margin_top = 62.0
margin_right = 505.0
margin_bottom = 262.0

[node name="Viewport" type="Viewport" parent="LeftHUD/ViewportContainer"]
size = Vector2( 200, 200 )
own_world = true
transparent_bg = true
handle_input_locally = false
render_target_update_mode = 3

[node name="Spatial" type="Spatial" parent="LeftHUD/ViewportContainer/Viewport"]
transform = Transform( -4.37114e-08, -1, -4.37114e-08, 0, -4.37114e-08, 1, -1, 4.37114e-08, 1.91069e-15, 0, 0, 0 )

[node name="Camera" type="Camera" parent="LeftHUD/ViewportContainer/Viewport/Spatial"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.275 )
projection = 1
size = 0.32

[node name="PositionGizmo" parent="LeftHUD/ViewportContainer/Viewport" instance=ExtResource( 4 )]

[node name="ViewportContainer2" type="ViewportContainer" parent="LeftHUD"]
margin_top = 266.0
margin_right = 505.0
margin_bottom = 466.0

[node name="Viewport" type="Viewport" parent="LeftHUD/ViewportContainer2"]
size = Vector2( 200, 200 )
own_world = true
transparent_bg = true
handle_input_locally = false
render_target_update_mode = 3

[node name="Spatial" type="Spatial" parent="LeftHUD/ViewportContainer2/Viewport"]
transform = Transform( -4.37114e-08, -1, -4.37114e-08, 0, -4.37114e-08, 1, -1, 4.37114e-08, 1.91069e-15, 0, 0, 0 )

[node name="Camera" type="Camera" parent="LeftHUD/ViewportContainer2/Viewport/Spatial"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.275 )
projection = 1
size = 0.32

[node name="RotationGizmo" parent="LeftHUD/ViewportContainer2/Viewport" instance=ExtResource( 5 )]

[node name="RightHUD" type="VBoxContainer" parent="."]
anchor_left = 0.5
anchor_right = 1.0
anchor_bottom = 1.0
margin_top = 7.0
margin_right = -7.0
margin_bottom = 39.0

[node name="PacketDelay" type="VBoxContainer" parent="RightHUD"]
margin_right = 505.0
margin_bottom = 32.0
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Label" type="Label" parent="RightHUD/PacketDelay"]
margin_right = 505.0
margin_bottom = 14.0
text = "Last Packet Delay:"
align = 2

[node name="HBoxContainer" type="HBoxContainer" parent="RightHUD/PacketDelay"]
margin_top = 18.0
margin_right = 505.0
margin_bottom = 32.0
alignment = 2

[node name="Label2" type="Label" parent="RightHUD/PacketDelay/HBoxContainer"]
margin_left = 473.0
margin_right = 505.0
margin_bottom = 14.0
text = "0 ms"
script = SubResource( 3 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Panel" type="Panel" parent="RightHUD/PacketDelay/HBoxContainer/Label2"]
show_behind_parent = true
anchor_right = 1.0
anchor_bottom = 1.0
__meta__ = {
"_edit_use_anchors_": false
}

[node name="CameraLock" type="Label" parent="RightHUD"]
margin_top = 36.0
margin_right = 505.0
margin_bottom = 50.0
custom_colors/font_color = Color( 1, 0, 0, 1 )
text = "Camera Locked"
align = 2
script = SubResource( 4 )

[node name="Control" type="Control" parent="RightHUD"]
margin_top = 54.0
margin_right = 505.0
margin_bottom = 84.0
rect_min_size = Vector2( 0, 30 )

[node name="HBoxContainer" type="HBoxContainer" parent="RightHUD"]
margin_top = 88.0
margin_right = 505.0
margin_bottom = 112.0
alignment = 2

[node name="ManualHome" type="Button" parent="RightHUD/HBoxContainer"]
margin_left = 342.0
margin_right = 443.0
margin_bottom = 24.0
size_flags_horizontal = 8
text = "Manual Home"
script = SubResource( 5 )

[node name="LineEdit" type="LineEdit" parent="RightHUD/HBoxContainer"]
margin_left = 447.0
margin_right = 505.0
margin_bottom = 24.0
align = 2
max_length = 1

[node name="Box" type="Spatial" parent="."]

[node name="Bot" parent="Box" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.320545 )

[node name="Box" type="CSGBox" parent="Box"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, -3.4 )
invert_faces = true
width = 2.5
height = 1.0
depth = 6.8

[node name="Camera" type="Camera" parent="."]
transform = Transform( -4.37114e-08, -1, -4.37114e-08, 0, -4.37114e-08, 1, -1, 4.37114e-08, 1.91069e-15, 0, 5, -3.4 )
script = ExtResource( 1 )
max_major_rotation_degrees = 0.0
offload_excess_major_rotation = false

[node name="RemoteTransform" type="RemoteTransform" parent="Camera"]
remote_path = NodePath("../../LeftHUD/ViewportContainer/Viewport/Spatial")
update_position = false
update_scale = false

[node name="RemoteTransform2" type="RemoteTransform" parent="Camera"]
remote_path = NodePath("../../LeftHUD/ViewportContainer2/Viewport/Spatial")
update_position = false
update_scale = false

[node name="DirectionalLight" type="DirectionalLight" parent="."]
transform = Transform( 0.45809, -0.504121, 0.732131, -0.847733, -4.84499e-08, 0.530422, -0.267397, -0.863633, -0.42736, 0.279014, 2.4613, 0 )
light_energy = 0.3
directional_shadow_mode = 1

[connection signal="pressed" from="LeftHUD/HBoxContainer2/CheckButton" to="LeftHUD/HBoxContainer2/CheckButton" method="_on_pressed"]
[connection signal="pressed" from="RightHUD/HBoxContainer/ManualHome" to="RightHUD/HBoxContainer/ManualHome" method="_on_ManualHome_pressed"]
[connection signal="camera_lock_changed" from="Camera" to="RightHUD/CameraLock" method="_on_Camera_camera_lock_changed"]
